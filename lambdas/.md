# Lambda Infrastructure

Este directorio contiene la infraestructura de Terraform para desplegar una función Lambda en AWS.

## Estructura de archivos

```
lambdas/
├── providers.tf         # Configuración de proveedores de Terraform
├── main.tf             # Recursos principales (Lambda, IAM, CloudWatch)
├── variables.tf        # Definición de variables
├── outputs.tf          # Outputs de la infraestructura
├── src/                # Código fuente de la Lambda
│   └── lambda_function.py
└── env/                # Configuraciones por entorno
    └── dev/
        └── dev.tfvars  # Variables para entorno de desarrollo
```

## Uso

### 1. Inicializar Terraform

```bash
cd lambdas
terraform init
```

### 2. Planificar el despliegue

```bash
terraform plan -var-file="env/dev/dev.tfvars"
```

### 3. Aplicar los cambios

```bash
terraform apply -var-file="env/dev/dev.tfvars"
```

### 4. Destruir la infraestructura (si es necesario)

```bash
terraform destroy -var-file="env/dev/dev.tfvars"
```

## Configuración

### Variables principales en `dev.tfvars`:

- `lambda_function_name`: Nombre de la función Lambda
- `lambda_runtime`: Runtime de Python (python3.11)
- `lambda_handler`: Handler de la función
- `lambda_timeout`: Timeout en segundos
- `lambda_memory_size`: Memoria en MB
- `lambda_environment_variables`: Variables de entorno

### Personalización del código

El código fuente de la Lambda se encuentra en `src/lambda_function.py`. Puedes modificar este archivo según tus necesidades.

## Recursos creados

- **AWS Lambda Function**: La función principal
- **IAM Role**: Rol de ejecución con permisos básicos
- **CloudWatch Log Group**: Para los logs de la función
- **Archive File**: ZIP con el código fuente

## Outputs disponibles

- `lambda_function_name`: Nombre de la función
- `lambda_function_arn`: ARN de la función
- `lambda_function_invoke_arn`: ARN de invocación
- `lambda_execution_role_arn`: ARN del rol de ejecución
- `lambda_log_group_name`: Nombre del grupo de logs

## Requisitos

- Terraform >= 1.0
- AWS CLI configurado con credenciales válidas
- Permisos para crear recursos Lambda, IAM y CloudWatch en AWS